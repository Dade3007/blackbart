<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/app-route/app-location.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="./blackbart-main-page.html">
<link rel="import" href="./blackbart-product-page.html">
<link href="https://fonts.googleapis.com/css?family=Sacramento" rel="stylesheet">
<dom-module id="blackbart-app">
    <template>
        <style>
        :host {
            /* --primary-color: #775D94; */
            --primary-color: purple;
        }

        #mainContent {
            margin: 0 auto;
            max-width: 1440px;
            height: auto;
        }

        paper-item iron-icon {
            margin-right: 10px;
        }

        #drawerHeader {
            background-color: var(--primary-color);
            color: white;
            font-family: 'Sacramento';
            font-size: 35px;
            padding-top: 7px;
        }

        a {
            color: inherit;
            /* blue colors for links too */
            text-decoration: inherit;
            /* no underline */
        }
        </style>
        <app-location route="{{route}}" use-hash-as-path></app-location>
        <app-route route="{{route}}" pattern="/:page" data="{{routeData}}" tail="{{subroute}}">
        </app-route>
        <paper-drawer-panel force-narrow id="drawer">
            <paper-header-panel drawer>
                <iron-selecton>
                    <paper-item id="drawerHeader">Canela</paper-item>
                    <paper-item data-page="home" on-tap="changeTab" sectionid="0">
                        <iron-icon icon="icons:home"></iron-icon>Home
                    </paper-item>
                    <template is="dom-repeat" items="{{sections}}">
                        <paper-item data-page$="{{item.name}}" on-tap="changeTab" sectionid$="{{item.id}}">{{item.name}}</paper-item>
                    </template>
                    </iron-selector>
            </paper-header-panel>
            <paper-header-panel main>
                <blackbart-header sections="{{sections}}"></blackbart-header>
                <div id="mainContent">
                    <iron-pages id="scaffolder" selected="{{pageSelected}}">
                        <blackbart-main-page current-page="{{mainSelected}}"></blackbart-main-page>
                        <blackbart-product-page></blackbart-product-page>
                        <div>page2</div>
                    </iron-pages>
                </div>
                <blackbart-footer></blackbart-footer>
            </paper-header-panel>
        </paper-drawer-panel>
    </template>
    <script>
    Polymer({

        is: 'blackbart-app',
        listeners: {
            'go-to-page': 'changePage',
            "add-to-cart": "_addToCart",
            "tab-change": "changeTab",
            "toggle-menu": "toggleMenu",
            "go-home": "goHome"

        },
        observerser: [
            "_routeChange(routeData)"
        ],
        properties: {
            mainSelected: {
                type: Number,
                value: 0
            },
            currentPage: {
                type: Number,
                value: 0
            },
            sections: {
                type: Array,
                value: [{
                    name: 'Chaquetas',
                    id: '1'
                }, {
                    name: 'Camisas',
                    id: '2'
                }, {
                    name: 'Pantalones',
                    id: '3'
                }, {
                    name: 'Faldas',
                    id: '4'
                }, {
                    name: 'Bolsos',
                    id: '5'
                }]
            },
            pageSelected: {
                type: Number,
                value: 0
            },
            cart: {
                type: Object
            }
        },
        attached: function() {
            if (!this.route.path) {
                this.set('route.path', '/home');
            }
        },
        goHome: function(){
            this.pageSelected = 0;
            this.mainSelected = 0;
            this.set('route.path', '/home');
        },
        _addToCart: function() {
            console.log('addToCart');
        },

        _routeChange: function(data) {
            console.log(data.page)
        },

        changePage: function(event, detail) {
            this.set('route.path', '/' + detail.routeName);
            this.pageSelected = detail.page;
        },

        changeTab: function(event, detail) {
            this.pageSelected = 0;
            detail.tabSelected == undefined ? this.mainSelected = event.target.getAttribute('sectionid') : this.mainSelected = detail.tabSelected + 1;

            this.toggleMenu();
        },

        toggleMenu: function() {
            if (window.innerWidth < 480) {
                this.$.drawer.togglePanel()
            }
        },
    });
    </script>
</dom-module>
